using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using Team12_SSIS.Model;

namespace Team12_SSIS.BusinessLogic
{

    //Yishu Line 15 to 315
    //Khair Line 316 to 616
    //Jane Line 617 to 917
    //Naing Line 1218 to 1518
    //Pradeep Line 1519 to 1820
    public class DisbursementLogic
    {































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































		public static List<CollectionPoint> ListCollectionPoints()
		{
			using (SA45Team12AD entities = new SA45Team12AD())
			{
				return entities.CollectionPoints.ToList();
			}
		}

		public static List<string> ListCollectionPointsWithTime()
		{
			List<CollectionPoint> cpList = new List<CollectionPoint>();
			cpList = DisbursementLogic.ListCollectionPoints();
			List<string> cpWithTimeList = new List<string>();
			foreach (CollectionPoint C in cpList)
			{
				string s = C.CollectionPoint1 + " " + C.CollectionTime;
				cpWithTimeList.Add(s);
			}
			return cpWithTimeList;
		}

		public static string GetCurrentDep()
		{
			return HttpContext.Current.Profile.GetPropertyValue("department").ToString();
		}

		public static string GetCurrentCPIDByDep(string dep)
		{
			using (SA45Team12AD entities = new SA45Team12AD())
			{
				return entities.Departments.Where(x => x.DeptID == dep).Select(x => x.CollectionPointID).Single().ToString();

			}
		}

		public static string GetCurrentCPWithTimeByID(int id)
		{
			using (SA45Team12AD entities = new SA45Team12AD())
			{
				string CPName = entities.CollectionPoints.Where(x => x.CollectionPointID == id).Select(x=>x.CollectionPoint1).Single().ToString();
				string CTime = entities.CollectionPoints.Where(x => x.CollectionPointID == id).Select(x => x.CollectionTime).Single().ToString();
				return CPName + " " + CTime;
			}
		}

		public static void UpdateCollectionPoint(string depid, int cpid)
		{
			using (SA45Team12AD entities = new SA45Team12AD())
			{
				Department department = entities.Departments.Where(p => p.DeptID== depid).First<Department>();
				department.CollectionPointID = cpid;
				entities.SaveChanges();
			}
		}

	}
}