using System;
using System.Collections.Generic;
using System.Data.Entity.Validation;
using System.Linq;
using System.Web;
using Team12_SSIS.Model;

namespace Team12_SSIS.BusinessLogic
{
    //Khair Line 15 to 315
    //Chang Siang Line 316 to 616
    //Jaining Line 617 to 917
    //Pradeep 1218 to 1518
    //Yishu Line 1519 to 1820
    public class PurchasingLogic
    {































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































        public static List<SupplierList> ListSuppliers()
        {
            using (SA45Team12AD entities = new SA45Team12AD())
            {
                return entities.SupplierLists.ToList<SupplierList>();
            }
        }

        public static void DeleteSupplier(string SupplierID)
        {
            using (SA45Team12AD entities = new SA45Team12AD())
            {
                SupplierList supplier = entities.SupplierLists.Where(s => s.SupplierID == SupplierID).First<SupplierList>();
                entities.SupplierLists.Remove(supplier);
                entities.SaveChanges();
            }
        }

        public static void UpdateSupplier(string SupplierID, string SupplierName, string GSTRegistrationNo, string ContactName, int PhoneNo, int FaxNo, string Address, int OrderLeadTime)
        {
            using (SA45Team12AD entities = new SA45Team12AD())
            {
                SupplierList supplier = entities.SupplierLists.Where(s => s.SupplierID == SupplierID).First<SupplierList>();
                supplier.SupplierName = SupplierName;
                supplier.GSTRegistrationNo = GSTRegistrationNo;
                supplier.ContactName = ContactName;
                supplier.PhoneNo = PhoneNo;
                supplier.FaxNo = FaxNo;
                supplier.Address = Address;
                supplier.OrderLeadTime = OrderLeadTime;
                entities.SaveChanges();
            }
        }

        public List<SupplierList> SearchBy(string value)
        {
            using (SA45Team12AD entities = new SA45Team12AD())
            {
                return entities.SupplierLists.Where(s => s.SupplierID.Contains(value) || s.SupplierName.Contains(value)).ToList();
            }
        }

        public static void AddSupplier(string SupplierID, string SupplierName, string GSTRegistrationNo, string ContactName, int PhoneNo, int FaxNo, string Address, int OrderLeadTime)
        {
            using (SA45Team12AD entities = new SA45Team12AD())
            {
                SupplierList supplier = new SupplierList();
                supplier.SupplierID = SupplierID;
                supplier.SupplierName = SupplierName;
                supplier.GSTRegistrationNo = GSTRegistrationNo;
                supplier.ContactName = ContactName;
                supplier.PhoneNo = PhoneNo;
                supplier.FaxNo = FaxNo;
                supplier.Address = Address;
                supplier.OrderLeadTime = OrderLeadTime;
                entities.SupplierLists.Add(supplier);
                entities.SaveChanges();
            }
            }
        
    }
}